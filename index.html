<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>캠퍼스 지도</title>
  <style>
    #map {
      width: 100%;
      height: 100vh;
    }
  </style>
  <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=b08bb0d7029cff05ee0ab4ab533493ce"></script>
</head>
<body>
  <div id="map"></div>

  <script>
    // 지도 생성
    const mapContainer = document.getElementById('map');
    const mapOption = {
      center: new kakao.maps.LatLng(36.839480, 127.184666),
      level: 4
    };
    const map = new kakao.maps.Map(mapContainer, mapOption);

    // 마커 스타일
    const coreMarkerImage = new kakao.maps.MarkerImage(
      'https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/marker_red.png',
      new kakao.maps.Size(32, 32)
    );
    const subMarkerImage = new kakao.maps.MarkerImage(
      'https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/marker_blue.png',
      new kakao.maps.Size(24, 24)
    );

    // JSON 불러오기
    fetch('graph.json')
      .then(res => res.json())
      .then(data => {
        for (const [name, info] of Object.entries(data)) {
          const position = new kakao.maps.LatLng(info.lat, info.lng);

          const marker = new kakao.maps.Marker({
            map,
            position,
            title: name,
            image: info.isCore ? coreMarkerImage : subMarkerImage
          });

          const infowindow = new kakao.maps.InfoWindow({
            content: `<div style="padding:5px;font-size:13px;">${name}</div>`
          });

          kakao.maps.event.addListener(marker, 'mouseover', () => infowindow.open(map, marker));
          kakao.maps.event.addListener(marker, 'mouseout', () => infowindow.close());
        }
      })
      .catch(error => console.error('graph.json 불러오기 실패:', error));
  </script>
</body>
</html>
